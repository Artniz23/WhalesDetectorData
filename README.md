# Whale Detector Data

## Описание проекта

Данный проект представляет собой модульный конвейер подготовки данных для задач компьютерного зрения, ориентированный на обучение моделей сегментации и детекции объектов в формате YOLO. Конвейер автоматизирует обработку размеченных изображений, начиная от преобразования бинарных масок в полигональную разметку и заканчивая формированием обучающей, валидационной и тестовой выборок.

Архитектура решения основана на принципах модульности, слабой связанности компонентов и последовательного выполнения этапов обработки, что обеспечивает расширяемость, воспроизводимость и удобство сопровождения.

---

## Основные возможности

- Преобразование бинарных масок в полигональную разметку
- Аугментация изображений и масок
- Корректное разбиение датасета на train / val / test
- Визуальная проверка корректности разметки
- Гибкая конфигурация через единый контекст обработки

---

## Установка зависимостей:
```bash
pip install -r requirements.txt
```

### Подготовка данных

Для начала работы необходимо:

1. Создать в корне проекта папку `dataset`.
2. Загрузить в папку `dataset` изображения китов и соответствующие бинарные маски, предоставленные заказчиком.
3. Для каждого изображения должна существовать маска с тем же именем файла и расширением `.png`.

Исходные данные должны быть организованы по папкам, соответствующим отдельным особям.

### Запуск обработки

Для запуска конвейера подготовки данных выполните команду:

```bash
python create_dataset.py
```

По завершении работы конвейера будет создана папка yolo_dataset со следующей структурой:

yolo_dataset/
├── augmented/
├── images/
│   ├── train/
│   ├── val/
│   └── test/
├── labels/
│   ├── train/
│   └── val/
└── visualized/
    ├── train/
    └── val/

- Каталог images содержит изображения обучающей, валидационной и тестовой выборок.
- Каталог labels содержит файлы полигональной разметки для обучающей и валидационной выборок.
- Каталог visualized предназначен для визуальной проверки корректности разметки.
- Папка augmented содержит данные после применения аугментаций.

